<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.water.Mulbburi.community.dao.CommunityMapper">

 <resultMap type="com.water.Mulbburi.community.dto.CommunityDTO" id="communityAllResultMap">
      <id property="communityNo" column="COMMUNITY_NO"/>
      <result property="communityTitle" column="COMMUNITY_TITLE"/>
      <result property="communityStory" column="COMMUNITY_STORY"/>
      <result property="communityWriteDate" column="COMMUNITY_WRITE_DATE"/>
      <result property="communityUpdateDate" column="COMMUNITY_UPDATE_DATE"/>
      <result property="communityDeleteDate" column="COMMUNITY_DELET_DATE"/>
      <result property="memberNo" column="MEMBER_NO"/>
      <result property="custom" column="CUSTOM"/>
     </resultMap>





<select id="selectTotalCount" resultType="_int">
SELECT 
    COUNT(*)
    FROM COMMUNITY
    WHERE COMMUNITY_DELET_DATE IS NULL

</select>

<!-- 게시물 목록 -->
<select id="selectThumbnailBoardList" resultMap="thumbnailBoardResultMap">
        SELECT 
	           A.BOARD_NO
	         , A.BOARD_TYPE
	         , D.FILE_TYPE
	         , D.THUMBNAIL_PATH
	         , A.BOARD_TITLE
	         , A.BOARD_BODY
	         , A.BOARD_WRITER_MEMBER_NO
	         , E.NICKNAME
	         , A.BOARD_COUNT
	         , A.CREATED_DATE
	         , A.BOARD_STATUS
          FROM (SELECT 
                       ROWNUM RNUM
                     , B.BOARD_NO
                     , B.BOARD_TYPE
			         , B.BOARD_TITLE
			         , B.BOARD_BODY
			         , B.BOARD_WRITER_MEMBER_NO
			         , B.BOARD_COUNT
			         , B.CREATED_DATE
			         , B.BOARD_STATUS
                  FROM (SELECT 
                               C.BOARD_NO
					         , C.BOARD_TYPE
					         , C.BOARD_TITLE
					         , C.BOARD_BODY
					         , C.BOARD_WRITER_MEMBER_NO
					         , C.BOARD_COUNT
					         , C.CREATED_DATE
					         , C.BOARD_STATUS
                          FROM TBL_BOARD C
                         WHERE C.BOARD_STATUS = 'Y'
				           AND C.BOARD_TYPE = 2
        				 ORDER BY C.BOARD_NO DESC
        				) B
        <![CDATA[
                  WHERE ROWNUM <= #{ endRow }
                  ]]>
        ) A
        JOIN TBL_ATTACHMENT D ON (A.BOARD_NO = D.REF_BOARD_NO)
        JOIN TBL_MEMBER E ON(A.BOARD_WRITER_MEMBER_NO = E.MEMBER_NO)
        WHERE A.RNUM >= #{ startRow }
        ORDER BY 1 DESC
    </select>




   

















</mapper>